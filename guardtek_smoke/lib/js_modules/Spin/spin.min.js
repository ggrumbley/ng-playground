(function(b,a){if(typeof exports=="object")module.exports=a();else if(typeof define=="function"&&define.amd)define(a);else b.Spinner=a()})(this,function(){"use strict";var j=["webkit","Moz","ms","O"],i={},e;function b(d,b){var c=document.createElement(d||"div"),a;for(a in b)c[a]=b[a];return c}function c(b){for(var a=1,c=arguments.length;a<c;a++)b.appendChild(arguments[a]);return b}var h=function(){var a=b("style",{type:"text/css"});c(document.getElementsByTagName("head")[0],a);return a.sheet||a.styleSheet}();function m(a,d,j,g){var c=["opacity",d,~~(a*100),j,g].join("-"),b=.01+j/g*100,k=Math.max(1-(1-a)/d*(100-b),a),f=e.substring(0,e.indexOf("Animation")).toLowerCase(),l=f&&"-"+f+"-"||"";if(!i[c]){h.insertRule("@"+l+"keyframes "+c+"{0%{opacity:"+k+"}"+b+"%{opacity:"+a+"}"+(b+.01)+"%{opacity:1}"+(b+d)%100+"%{opacity:"+a+"}100%{opacity:"+k+"}}",h.cssRules.length);i[c]=1}return c}function f(e,a){var d=e.style,c,b;if(d[a]!==undefined)return a;a=a.charAt(0).toUpperCase()+a.slice(1);for(b=0;b<j.length;b++){c=j[b]+a;if(d[c]!==undefined)return c}}function a(a,c){for(var b in c)a.style[f(a,b)||b]=c[b];return a}function k(a){for(var b=1;b<arguments.length;b++){var d=arguments[b];for(var c in d)if(a[c]===undefined)a[c]=d[c]}return a}function l(a){var b={x:a.offsetLeft,y:a.offsetTop};while(a=a.offsetParent)b.x+=a.offsetLeft,b.y+=a.offsetTop;return b}var n={lines:12,length:7,width:5,radius:10,rotate:0,corners:1,color:"#000",direction:1,speed:1,trail:100,opacity:1/4,fps:20,zIndex:2e9,className:"spinner",top:"auto",left:"auto",position:"relative"};function d(a){if(typeof this=="undefined")return new d(a);this.opts=k(a||{},d.defaults,n)}d.defaults={};k(d.prototype,{spin:function(g){this.stop();var d=this,c=d.opts,f=d.el=a(b(0,{className:c.className}),{position:c.position,width:0,zIndex:c.zIndex}),k=b("div",{className:c.className+"-box"}),i=b("div",{className:c.className+"-overlay"}),u=c.radius+c.length+c.width,s,t;if(c.className=="custom-spinner"){i.appendChild(k);k.appendChild(f)}if(g){g.insertBefore(c.className=="custom-spinner"?i:f,g.firstChild||null);t=l(g);s=l(f)}f.setAttribute("role","progressbar");d.lines(f,d.opts);if(!e){var n=0,q=(c.lines-1)*(1-c.direction)/2,j,m=c.fps,h=m/c.speed,p=(1-c.opacity)/(h*c.trail/100),o=h/c.lines;(function r(){n++;for(var a=0;a<c.lines;a++){j=Math.max(1-(n+(c.lines-a)*o)%h*p,c.opacity);d.opacity(f,a*c.direction+q,j,c)}d.timeout=d.el&&setTimeout(r,~~(1e3/m))})()}return d},stop:function(){var a=this.el;if(a){clearTimeout(this.timeout);if(a.className=="custom-spinner"&&a.parentNode.parentNode.parentNode)a.parentNode.parentNode.parentNode.removeChild(a.parentNode.parentNode);else a.parentNode&&a.parentNode.removeChild(a);this.el=undefined}return this},lines:function(i,d){var f=0,j=(d.lines-1)*(1-d.direction)/2,g;function h(e,c){return a(b(),{position:"absolute",width:d.length+d.width+"px",height:d.width+"px",background:e,boxShadow:c,transformOrigin:"left",transform:"rotate("+~~(360/d.lines*f+d.rotate)+"deg) translate("+d.radius+"px,0)",borderRadius:(d.corners*d.width>>1)+"px"})}for(;f<d.lines;f++){g=a(b(),{position:"absolute",top:1+~(d.width/2)+"px",transform:d.hwaccel?"translate3d(0,0,0)":"",opacity:d.opacity,animation:e&&m(d.opacity,d.trail,j+f*d.direction,d.lines)+" "+1/d.speed+"s linear infinite"});d.shadow&&c(g,a(h("#000","0 0 4px #000"),{top:"2px"}));c(i,c(g,h(d.color,"0 0 1px rgba(0,0,0,.1)")))}return i},opacity:function(a,b,c){if(b<a.childNodes.length)a.childNodes[b].style.opacity=c}});function o(){function e(c,a){return b("<"+c+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',a)}h.addRule(".spin-vml","behavior:url(#default#VML)");d.prototype.lines=function(l,b){var f=b.length+b.width,g=2*f;function i(){return a(e("group",{coordsize:g+" "+g,coordorigin:-f+" "+-f}),{width:g,height:g})}var h=-(b.width+b.length)*2+"px",k=a(i(),{position:"absolute",top:h,left:h}),d;function j(h,g,d){c(k,c(a(i(),{rotation:360/b.lines*h+"deg",left:~~g}),c(a(e("roundrect",{arcsize:b.corners}),{width:f,height:b.width,left:b.radius,top:-b.width>>1,filter:d}),e("fill",{color:b.color,opacity:b.opacity}),e("stroke",{opacity:0}))))}if(b.shadow)for(d=1;d<=b.lines;d++)j(d,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(d=1;d<=b.lines;d++)j(d);return c(l,k)};d.prototype.opacity=function(e,c,d,b){var a=e.firstChild;b=b.shadow&&b.lines||0;if(a&&c+b<a.childNodes.length){a=a.childNodes[c+b];a=a&&a.firstChild;a=a&&a.firstChild;if(a)a.opacity=d}}}var g=a(b("group"),{behavior:"url(#default#VML)"});if(!f(g,"transform")&&g.adj)o();else e=f(g,"animation");return d})